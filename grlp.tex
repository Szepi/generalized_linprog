%!TEX root =  autocontgrlp.tex
\section{Generalized Reduced Linear Program}
\begin{assumption}\label{grlpassmp}
\begin{enumerate}[(i)]
\item \label{probdist} $c=(c(i),i=1,\ldots,n)\in \R^n$ is a positive probability distribution, i.e., $c(i)>0 \mb \forall i$ and $\sum_{i=1}^n c(i)=1$.
\item  \label{one} The first column of the feature matrix $\Phi$ (i.e., $\phi_1$) is $\one \in \R^n$. 
\item \label{lyap} $\psi\colon S \ra \R_+$ is a Lyapunov function for $P$
and is present in the column span of the feature matrix $\Phi$: For some $r_0\in \R^k$, $\Phi r_0 = \psi$. 
\item \label{nassmp} $\N\subset \R^k$ is compact and $\tr \in \N\subset\R^k$.
\item \label{wassump} $W \in \R^{nd\times m}_+$ is a full rank $nd\times m$ matrix (where $m\ll nd$), with all non-negative entries such that each of its column-sums equals one.
\item \label{ass:n4} The set $\N'$ is such that $\N' = \N + t r_0$ for any $t\in \R$, where $r_0\in \R^k$ such that $\Phi r_0 = \psi$.
\end{enumerate}
\end{assumption}
When \cref{grlpassmp}-\eqref{lyap} holds, it follows that for any $J\in \R^n$, $t>0$, $s\in S$,
\begin{align}
\label{eq:psilin}
T(J+ t \psi ) \le TJ + \beta_{\psi}\,t\,  \psi\,\, \quad (J\in \R^n,\, t>0)\,.
\end{align}
The approximate linear program (ALP) is obtained by making use of LFA in the LP, i.e., by adding the extra constraint $J=\Phi r$ in \eqref{mdplp} with $\Phi \in \R^{n\times k}$ and introducing the new variables $r\in \R^k$. By substitution, this leads to
\begin{align}\label{alp}
\begin{split}
\min_{r\in \R^k}\, &c^\top \Phi r\\
\text{s.t.}\mb &\Phi r\geq T \Phi r,
\end{split}
\end{align}
where $J\geq TJ$ is a shorthand for the $nd$ constraints in \eqref{mdplp}. Unless specified otherwise we use $\tr$ to denote any solution to the ALP, $\tj=\Phi \tr$ to denote the corresponding approximate value function and $\tu$ to denote the greedy policy with respect to $\tj$.
The Generalized Reduced Linear Program is given as:
\begin{align}\label{grlp}
\begin{split}
\underset{r\in \N}{\min}\, &\, c^\top \Phi r,\\
\text{s.t.}\mb & \,W^\top E\Phi r\geq W^\top H \Phi r,
\end{split}
\end{align}
where $W \in \R^{nd\times m}_+$ is a matrix with all positive entries and $\N$ is an additional constraint set to ensure the boundedness of the solution.
In what follows, we denote the solution to the GRLP by $\hr$, the approximate value function by $\hj=\Phi \hr$ and use $\hu$ to denote the greedy policy with respect to $\hj$.

