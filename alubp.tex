%!TEX root =  autocontgrlp.tex
\section{Approximate Least Upper Bound Projection}\label{sec:alubp}
We define an approximate least upper bound (ALUB) projection operator which has a structure similar to the GRLP and is an approximation to the LUB operator.
\begin{definition}\label{alubpop}
Given $J\in \R^n$, its approximate least upper bound (ALUB) projection is denoted by $\hg J$ and is defined as 
\begin{align}\label{tgamdef}
(\hg J)(i)\stackrel{\Delta}{=}\underset{j=1,\ldots,k}{\min} (\Phi r_{e_j})(i), \mb i=1,\ldots,n,
\end{align}
where $r_{e_j}$ is a solution to the linear program in \eqref{alubplp} for $c=e_j$, and $e_j$ is the same as in Definition~\ref{lubpop}.
\begin{align}\label{alubplp}
r_c\stackrel{\Delta}{=} & \argmin_{r\in \chi} c^\top \Phi r,\nn\\
& \text{s.t.}\,\,\, W^\top E \Phi r\geq W^\top HJ,\,\, W \in \R^{nd\times m}_+ .
\end{align}
\end{definition}
Note that $W$ in \eqref{alubplp} is the same matrix that is used in \eqref{grlp} and satisfies Assumption~\ref{wassump}.
\begin{lemma}\label{tgmonotone}
For $J_1, J_2\in \R^n$ such that $J_1\geq J_2$, we have $\hg J_1\geq \hg J_2$.
\end{lemma}
\begin{proof}
The proof follows from Assumptions~\ref{wassump} and ~\ref{one} using arguments along the lines of Lemma~\ref{gmonotone}.
\end{proof}
\begin{lemma}\label{tgshift}
Let $J_1\in \R^n$ and $t\in \R$ be a constant. If $J_2=J_1+t\one$, then $\hg J_2=\hg J_1+\alpha t\one$.
\end{lemma}
\begin{proof}
The proof follows from Assumption~\ref{wassump} and ~\ref{one}, as well as Lemma~\ref{lpsol} using arguments along the lines of Lemma~\ref{gshift}. In particular, consider the $i^{th}$ linear program corresponding to $\hg J_1$ and $\hg J_2$. Now, the result follows by letting $A=W^\top E \Phi$, $b=W^\top H J$, $c=e_i$, $b_0=\alpha t \mathbf{1}$, $x_0=\alpha t e_i$.
\end{proof}
\begin{theorem}\label{tgmaxcontra}
The operator $\hg \colon \R^n\ra \R^n$ obeys the $\max$-norm contraction property with factor $\alpha$ and the following iterative scheme based on the ALUB projection operator $\hg$, see \eqref{apvi}, converges to a unique fixed point $\hv$.
\begin{align}\label{apvi}
V_{n+1}&=\hg V_n,\mb n\geq 0.
\end{align}
\end{theorem}
\begin{proof}
Follows along similar lines as the proof of Theorem~\ref{gmaxcontra}.
\end{proof}
\begin{lemma}\label{relation2}
The unique fixed point $\hv$ of the iteration in \eqref{apvi} and the solution $\hj$ of the GRLP \eqref{grlp} obey $\hj\geq\hv$.
\end{lemma}
\begin{proof}
The proof follows in a similar manner as the proof of Lemma~\ref{relation1}. To elaborate, let $\Phi r_1, \Phi r_2,\ldots,\Phi r_n$ be solutions to the GRLP in \eqref{grlp} for $c=e_1, e_2,\ldots,e_n$ respectively. Fix some other $c\in [0,1]^n$, $\sum_i c(i)=1$.
Now consider the iterative scheme in \eqref{apvi} with $V_0(i)=\underset{j=1,\ldots,n}{\min}(\Phi r_j)(i)$. 
It is clear from the definition of $V_0$ that $\hj(i),(\Phi r_j)(i)\geq(\Phi r_i)(i)$, $i=1,\ldots,n$.
In particular, it follows that $V_0(i) =( \Phi r_i)(i)$ and so
$\Phi r_i \geq V_0$.
From the monotone property of $T$ (viz. $H$) we have 
$H\Phi r_i\geq H V_0$ and also, by minimizing component-wise
$E\Phi r_i\geq H\Phi r_i\geq HV_0$. Thus,
$E V_0\geq H V_0$. 
\todoc[inline]{I lost why this was needed.
I think the proof would be much easier to understand if we introduced $r_{c,J} = \argmin_{r} \{ c^\top \Phi r \,|\, W^\top E \Phi r \ge W^\top H J\}$. We could start by saying we need $V_1\le V_0 \le \hj$ because then Lemma~\ref{tgmonotone} will give the desired result. Next, $V_0\le \hj$ holds because on the one hand, $\hj(i) \ge (\Phi r_i)(i)$ for any $i$, while on the other hand,
$(\Phi r_j)(i) \ge (\Phi r_i)(i)$ also holds for any $i,j$, hence $V_0(i)  = (\Phi r_i)(i)$. 
Now, for showing that $V_1 \le V_0$ holds, fix any $i$. We need to show that $(\hg V_0)(i) = \min_j (\Phi r_{e_j,V_0})(i) = (\Phi r_{e_i,V_0})(i)$ is less than $V_0(i)$. By the definition of $r_{e_j,V_0}$ we know that $(\Phi r_{e_i,V_0})(i) \le (\Phi r)(i)$
holds for any $r$ such that $W^\top E \Phi r \ge W^\top H V_0$. Thus, it suffices to show that $r_i$ satisfies this latter inequality,
i.e., $W^\top E \Phi r_i \ge W^\top H V_0$. For this, it clearly sufficient if $\Phi r_i \ge V_0$. This however directly follows 
from the definition of $V_0$.
}
Since $V_1=\hg V_0$, from the definition of $\hg$ in \eqref{gamdef} and the construction of $V_0$, we have $V_0\geq V_1$, and recursively $V_{n}\geq V_{n+1}, \mb n\geq 0$. So it follows that $\hj\geq V_0\geq V_1\ldots\geq \hv$.
\end{proof}
\begin{theorem}\label{mt1}
Let $\hv$ be the fixed point of the iterative scheme in \eqref{apvi} and let $\bj$ be the best possible LUB approximation of $J^*$ as in Definition~\ref{bestproj}. Then,
\begin{align}
||J^*-\hv||_\infty\leq \frac{||J^*-\bj||_\infty+||\Gamma J^*-\hg J^*||_\infty}{1-\alpha}.
\end{align}
\end{theorem}
\begin{proof}
Let $\epsilon=||J^*-\bj||_\infty$, and $\{V_n\},n\geq 0$ be the iterates of the scheme in \eqref{apvi} with $V_0=\hg J^*$, then
\todoc{Can the proof be simplified similarly to that of Theorem~\ref{fxpres}? Not a high priority.}
\begin{align}
||J^*-\hg J^*||_\infty&\leq||J^*-\Gamma J^*||_\infty+||\Gamma J^*-\hg J^*||_\infty\nn\\
&= \epsilon+\beta,
\end{align}
where $\beta=||\Gamma J^*-\hg J^*||_\infty$. Now
\begin{align}
||J^*-\hv||_\infty&\leq ||J^*-V_0+V_0-V_1+V_1\ldots-\hv||_\infty\nn\\
&\leq ||J^*-V_0||_\infty+||V_0-V_1||_\infty+||V_1-V_2||_\infty+\ldots\nn\\
&=||J^*-V_0||_\infty+||\hg J^*-\hg V_0||_\infty+\ldots\nn\\
&\leq (\epsilon+\beta)+\alpha(\epsilon+\beta)+\ldots\nn\\
&=\frac{\epsilon+\beta}{1-\alpha}.
\end{align}
\end{proof}
\begin{corollary}\label{cmt1}
Let $\hv$, $\bj$ be as in Theorem~\ref{mt1} and let $r^*\stackrel{\Delta}{=}\argmin_{r\in \R^k}||J^*-\Phi r||_\infty$, then
\begin{align}
||J^*-\hv||_\infty\leq \frac{2||J^*-\Phi r^*||_\infty+||\Gamma J^*-\hg J^*||_\infty}{1-\alpha}.
\end{align}
\end{corollary}
\begin{proof}
The result is obtained by using Lemma~\ref{bestbnd} to replace the term $||J^*-\bj||_\infty$ in Theorem~\ref{mt1}.
\end{proof}
