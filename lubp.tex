%!TEX root =  autocontgrlp.tex
\section{Least Upper Bound Projection}\label{sec:lubp}
The least upper bound (LUB) projection operator $\Gamma \colon \R^n \ra\R^n$ is defined as below:
\begin{definition}\label{lubpop}
Given $J\in \R^n$, its least upper bound projection is denoted by $\Gamma J$ and is defined as 
\begin{align}\label{gamdef}
(\Gamma J)(i)\eqdef(\Phi r_{e_i,J})(i),\quad i=1,\ldots,n,
\end{align}
where $V(i)$ denotes the $i^{th}$ component of the vector $V\in \R^n$. Also in \eqref{gamdef}, $e_j$ is the vector with $1$ in the $j^{th}$ place and zeros elsewhere, and $r_{e_j}$ is a solution to the linear program in \eqref{lubplp} for $c=e_j$:
\begin{align}\label{lubplp}
 r_{c,J}   \eqdef& \underset{r\in \N}{\argmin} \mbox{ } c^\top \Phi r,\nn\\
 \text{s.t.}& \mb \Phi r\geq  TJ.
\end{align}
\end{definition}
%Note that $r_{e_j}$ depends on $J$, but this dependence is suppressed to reduce clutter. 
\begin{remark}
\begin{enumerate}
\item The definition of LUB operator $\Gamma \colon \R^n \ra \R^n$ involves $n$ associated linear programs.
\item Observe that $\Gamma J\geq TJ$ (follows from the fact that if $a\geq c$ and $b\geq c$, then $\min(a,b)\geq c$, where $a, b, c \in \R$).
\item Given $\Phi$ and $J\in \R^n$, define $\F\eqdef\{\Phi r|\Phi r\geq TJ\}$. Thus $\F$ is the set of all vectors in the span of $\Phi$ that upper bound $TJ$. By fixing $c$ in the linear program in \eqref{lubplp} we select a unique vector $\Phi r_c \in \F$. The LUB projection operator $\Gamma$ picks $n$ vectors $\Phi r_{e_i},i=1,\ldots,n$ from the set $\F$ and $\Gamma J$ is obtained by computing their component-wise minimum.
\item Even though $\Gamma J$ does not belong to the span of $\Phi$, $\Gamma J$ collates the various best upper bounds that can be obtained via the linear program in \eqref{lubplp}.
\begin{comment}
\item The LUB operator $\Gamma$ in \eqref{gamdef} bears close similarity to the ALP in \eqref{alp}.
In fact, it is not hard to observe that $(\Gamma J)(i) = (\Phi r_{e_i})(i)$ for any $1\le i \le n$; the reason $\Gamma$ is defined the way it is so that this resembles to \eqref{alp} will be clear. 
\end{comment}
\todoc{In fact, I would prefer the simpler definition without the $\min$ and then changing this remark.}
\end{enumerate}
\end{remark}
\begin{definition}\label{bestproj}
The LUB projection of $J^*$ is denoted by $\bj=\Gamma J^*$.
\end{definition}
We now characterize the LUB projection operator $\Gamma$ in the following lemmas. 
As mentioned earlier, the error analysis depends on two $\max$-norm contraction operators the first of which is $\Gamma$. The important result of this section is Theorem~\ref{fxpres} and it relates the fixed point $\tv$ of $\Gamma$ to $J^*$.
\todoc{Poor choice of symbols: $\tv$ is the fixed point of $\Gamma$ and $\hat{V}$ will be the fixed point of $\tilde{\Gamma}$? Hmm.. Not a high priority to change it, but still..}
\begin{lemma}\label{bestbnd}
Let $r^*\in \R^k$ be defined as $r^*\eqdef\argmin_{r\in R^k}||J^*-\Phi r||_\infty$, then 
\begin{align}
||J^*-\bj||_\infty\leq 2||J^*-\Phi r^*||_\infty.
\end{align}
\end{lemma}
\begin{proof}
The result follows from the definition of $\Gamma$ in \eqref{gamdef} and the construction of $V_0$, Assumption~\ref{one}, and the fact that $\Phi r^*+||J^*-\Phi r^*||_\infty \one\geq TJ^*$. To see this, note that
\begin{align}
\Gamma J^*=\hj \geq J^*,\nn \text{ and }
\Phi r^* +||J^*-\Phi r^*||_\infty\geq TJ^*= J^*.\nn
\end{align}
Thus,
\begin{align}
\Phi r^* +||J^*-\Phi r^*||_\infty\geq \Gamma J^*\geq TJ^*.
\end{align}
\end{proof}

\begin{lemma}\label{gmonotone}
For $J_1, J_2\in \R^n$ such that $J_1\geq J_2$, we have $\Gamma J_1\geq \Gamma J_2$.
\end{lemma}
\begin{proof}
Choose any $i\in \{1,\ldots,n\}$ and let $r_{e_i,J_1}$ and $r_{e_i,J_2}$ be solutions to the linear program in \eqref{lubplp} for $c=e_i$ with $J=J_1$ and $J=J_2$ respectively. Since $J_1\geq J_2$, we have $TJ_1\geq TJ_2$ and $e_i^\top \Phi r_{e_i,J_1} \geq e_i^\top \Phi r_{e_i,J_2}$, i.e., $(\Phi r_{e_i,J_1})(i)\geq (\Phi r_{e_i,J_2})(i)$. The result follows from the fact that $(\Gamma J)(i)=(\Phi r_{e_i,J})(i)$, $J\in \R^n$, and our choice of $i$ was arbitrary.
\end{proof}
\begin{lemma}\label{lpsol}
Let $A\in \R^{u\times v}$, $b,c\in R^u$, $x_0 \in R^v$ and $b_0=Ax_0$. Then
\begin{align}
\min\{c^\top Ax:Ax\geq b+b_0\} =\min\{c^\top Ax:Ax\geq b\}+c^\top b_0.
\end{align}
\end{lemma}
\begin{proof}
The claim can be shown by a simple change of variables.
\end{proof}
\begin{lemma}\label{gshift}
Let $J_1\in \R^n$ and $t\in \R$ be a constant. If $J_2=J_1+t\one$, then $\Gamma J_2=\Gamma J_1+\alpha t\one$.
\end{lemma}
\begin{proof}
Consider the $i^{th}$ linear programs associated with $\Gamma J_1$ and $\Gamma J_2$. The result follows by using Lemma~\ref{lpsol} with $A=\Phi$, $b=TJ$, $c=e_i$, $b_0=\alpha t\mathbf{1}$ and $x_0=\alpha t e_i$.
\end{proof}
\begin{theorem}\label{gmaxcontra}
The operator $\Gamma  \colon \R^n\ra \R^n$ obeys the $\max$-norm contraction property with factor $\alpha$.
\end{theorem}
\begin{proof}
Given $J_1,J_2\in \R^n,$ let $\epsilon=||J_1-J_2||_\infty$. Thus,
\begin{align}\label{ineq}
J_2-\epsilon\one\leq J_1\leq J_2+\epsilon \one.
\end{align}
From Lemmas~\ref{gmonotone} and ~\ref{gshift}, we can write
\begin{align}\label{ineq}
\Gamma J_2-\alpha \epsilon\one\leq \Gamma J_1\leq \Gamma J_2+\alpha \epsilon\one.
\end{align}
\end{proof}
\begin{corollary}
Let $V_0$ be arbitrary and $(V_n)$ be defined recursively by
\begin{align}\label{pvi}
V_{n+1}&=\Gamma V_n, \quad n\geq 0\,.
\end{align}
Then, $V_n$ converges to the the unique fixed point $\tv$ of $\Gamma$.
\end{corollary}
\begin{lemma}\label{gfp}
 $\tv$, the unique fixed point of the iterative scheme \eqref{pvi}, obeys $\tv\geq T\tv$.
\end{lemma}
\begin{proof}
Consider the $i^{th}$ linear program associated with $\Gamma \tv$. We know that $\Phi r_{e_i}\geq T \tv$, for all $i=1,\ldots, n$. The result follows from noting that $\tv$ is the unique fixed point of $\Gamma $ and that $\tv(i)=(\Phi r_{e_i,V})(i)$.
\end{proof}
\begin{lemma}\label{relation1}
 $\tv$, the unique fixed point of the iterative scheme \eqref{pvi}, and the solution $\tj$ to the ALP in \eqref{alp}, obey the relation $\tj\geq\tv\geq J^*$.
\end{lemma}
\begin{proof}
Since $\tv\geq T\tv$ it follows that $\tv\geq J^*$. Let $\Phi r_1, \Phi r_2,\ldots,\Phi r_n$ be solutions to the ALP in \eqref{alp} for $c=e_1, e_2,\ldots,e_n$ respectively. Now consider the iterative scheme in \eqref{pvi} with $V_0(i)=\underset{j=1,\ldots, n}{\min}(\Phi r_j)(i)$. It is clear from the definition of $V_0$ that $\tj(i)\geq\Phi r_i(i)\geq V_0(i)$, $i=1,\ldots,n$. Also from the monotone property of $T$, we have 
\begin{align}\label{lineq}
\Phi r_i&\geq V_0,\nn\\
T\Phi r_i&\geq T V_0,\nn
\end{align}
hence we also have,
$\Phi r_i\geq T\Phi r_i \geq T V_0$, 
and so by taking component-wise minimum,
$V_0 \geq T V_0$.

From the first three inequalities in \eqref{lineq}, $\Phi r_i\geq T \Phi r_i\geq T V_0$, $i=1,\dots, n$ and hence $V_0\geq TV_0$. Since $V_1=\Gamma V_0$, from the definition of $\Gamma$ in \eqref{gamdef} we have $V_0\geq V_1$, and recursively $V_{n}\geq V_{n+1}$, $n\geq 0$. So it follows that $\tj\geq V_0\geq V_1\ldots\geq \tv$.
\end{proof}
\input{perfbnds}
